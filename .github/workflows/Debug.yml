name: Test Repository Secrets

on: workflow_dispatch

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - name: 最简单的验证
        run: |
          echo "=== 验证仓库级 Secrets ==="
          echo ""
          
          # 方法1：直接检查长度
          TOKEN_LEN=${#CLOUDFLARE_API_TOKEN}
          ACCOUNT_ID="$CLOUDFLARE_ACCOUNT_ID"
          
          echo "CLOUDFLARE_API_TOKEN:"
          if [ $TOKEN_LEN -gt 0 ]; then
            echo "✅ 已设置 (${TOKEN_LEN} 字符)"
          else
            echo "❌ 未设置或为空"
          fi
          
          echo ""
          echo "CLOUDFLARE_ACCOUNT_ID:"
          if [ -n "$ACCOUNT_ID" ]; then
            echo "✅ 已设置"
            echo "   值: $ACCOUNT_ID"
          else
            echo "❌ 未设置或为空"
          fi
          
          echo ""
          echo "=== 调试信息 ==="
          echo "如果显示 '***' 表示 Secrets 被 GitHub 隐藏"
          echo "如果显示实际值表示是普通变量"
          echo ""
          echo "CLOUDFLARE_API_TOKEN 变量: $CLOUDFLARE_API_TOKEN"
          echo "CLOUDFLARE_ACCOUNT_ID 变量: $CLOUDFLARE_ACCOUNT_ID"
        env:
          CLOUDFLARE_API_TOKEN: ${{ secrets.CLOUDFLARE_API_TOKEN }}
          CLOUDFLARE_ACCOUNT_ID: ${{ secrets.CLOUDFLARE_ACCOUNT_ID }}